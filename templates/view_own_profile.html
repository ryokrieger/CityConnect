<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Profile - CityConnect</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/users/profile.css') }}">
</head>
<body>
    <div class="top-bar">
        <a href="{{ url_for('dashboard') }}">← Back to Dashboard</a>
    </div>

    <div class="container">

        <!-- Profile header with username and location -->
        <div class="profile-header">
            <h1>{{ profile.username or 'User Profile' }}</h1>
            <p class="location">{{ profile.city_name }}{{ ', ' + profile.area_name if profile.area_name else '' }}</p>
        </div>

        <!-- Basic Information card -->
        <div class="card">
            <h2>Basic Information</h2>
            <div class="info-row">
                <span class="info-label">Username:</span>
                <span class="info-value">{{ profile.username or 'Not specified' }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Email:</span>
                <span class="info-value">{{ profile.email or 'Not specified' }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">City:</span>
                <span class="info-value">{{ profile.city_name or 'Not specified' }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Neighborhood:</span>
                <span class="info-value">{{ profile.area_name or 'Not specified' }}</span>
            </div>
        </div>

        <!-- Interests card -->
        <div class="card">
            <h2>My Interests</h2>
            {% if interests %}
                <div class="interests">
                    {% for interest in interests %}
                        <span class="interest-tag">{{ interest }}</span>
                    {% endfor %}
                </div>
            {% else %}
                <p class="empty-message">No interests selected yet.</p>
            {% endif %}
        </div>

        <!-- Ratings card -->
        <div class="card">
            <h2>My Ratings</h2>
            <div class="rating-box">
                <!-- Average rating number -->
                <div class="rating-number">{{ avg_rating or '0.0' }}</div>

                <!-- Star display based on rating -->
                <div class="stars">
                    {% set rating = avg_rating|float if avg_rating else 0 %}
                    {% for i in range(5) %}
                        {% if i < rating %}★{% else %}☆{% endif %}
                    {% endfor %}
                </div>

                <!-- Review count text -->
                <p class="rating-text">
                    Based on {{ reviews|length if reviews else 0 }} review{{ 's' if reviews and reviews|length != 1 else '' }}
                </p>
            </div>

            <!-- List of recent reviews -->
            {% if reviews %}
                <h3 style="color: #1e293b; margin-bottom: 16px; font-size: 18px;">Recent Reviews</h3>
                {% for review in reviews %}
                    <div class="review">
                        <div class="review-header">
                            <span class="reviewer-name">{{ review.username }}</span>
                            <span class="review-rating">{{ review.rating }}/5</span>
                        </div>
                        {% if review.comments %}
                            <div class="review-comment">"{{ review.comments }}"</div>
                        {% endif %}
                    </div>
                {% endfor %}
            {% else %}
                <p class="empty-message">No ratings received yet.</p>
            {% endif %}
        </div>
    </div>
</body>
</html>